{
  "name": "sox-audio",
  "version": "0.2.0",
  "description": "A NodeJS interface to SoX audio utilities",
  "main": "index.js",
  "scripts": {
    "test": "echo \"Error: no test specified\" && exit 1"
  },
  "repository": {
    "type": "git",
    "url": "https://github.com/psaylor/sox-audio.git"
  },
  "keywords": [
    "sox",
    "audio",
    "util",
    "stream",
    "transcode",
    "concat",
    "concatenate"
  ],
  "author": {
    "name": "Patricia Saylor",
    "email": "psaylor@mit.edu",
    "url": "http://patriciasaylor.com/"
  },
  "license": "MIT",
  "bugs": {
    "url": "https://github.com/psaylor/sox-audio/issues"
  },
  "homepage": "https://github.com/psaylor/sox-audio",
  "readme": "# sox-audio - A NodeJS interface to SoX audio utilities\nThis Node.js module abstracts the command-line usage of SoX so you can create complex SoX commands and run them with ease. You must have SoX installed in order to use this module.\n\n## Requirements\nYou must have sox installed in order to use this module, and you must add it to your PATH. [Visit the sox website](http://sox.sourceforge.net/Main/HomePage) to download it.\n\n## Installation\nYou can install sox-audio through npm:\n````\nnpm install sox-audio\n````\n\n## Usage\nThere are many usage examples in the [examples](./examples) folder, including how to concatenate and trim files, and how to transcode a raw audio stream into a wav audio stream. \n\n### Creating a SoxCommand\nThe sox-audio module returns a constructor that you can use to instantiate Sox commands. You can instantiate a SoxCommand with or without the `new` operator.\n```js\nvar SoxCommand = require('sox-audio');\nvar command = SoxCommand();\n```\nYou may pass an input file name or readable stream, and/or an options object, to the constructor.\n```js\nvar command = SoxCommand('examples/assets/utterance_0.wav');\nvar command = SoxCommand(fs.createReadStream('examples/assets/utterance_0.wav'));\nvar command = SoxCommand({option: \"value\", ... });\n```\n\n### Inputs\nSoxCommands accept one or any number of inputs. There are 4 different acceptable types of inputs:\n* a file name, e.g. `'examples/assets/utterance_0.wav'`\n* a readable stream, e.g. `fs.createReadStream('examples/assets/utterance_0.wav')`, however only one input stream may be used per command \n* another SoxCommand, which must set its output to `'-p'` for piping the result of this subcommand as input into the main SoxCommand, and it must provide an outputFileType. You may use more than one input of this type in a command.\n* a string for a subcommand to be executed and whose output should be piped as input into the SoxCommand, e.g.`'|sox examples/assets/utterance_0.wav -t wav -p trim 5'`. For this string, follow the format specified in the [SoX documentation](http://sox.sourceforge.net/sox.html#FILENAMES). You may use more than one input of this type in a command.\n\n```js\n// Passing an input to the constructor is the same as calling .input()\nvar command1 = SoxCommand('examples/assets/utterance_0.wav')\n  .input('examples/assets/utterance_1.wav')\n  .input(fs.createReadStream('examples/assets/utterance_2.wav'));\n\n// A string for a subcommand may be passed as input, following the format '|program [options]'. \n// The program in the subcommand does not have to be sox, it could be any program whose stdout \n// you want to use as an input file.\nvar command2 = SoxCommand()\n  .input('|sox examples/assets/utterance_0.wav -t wav -p trim 5 35');\n  \n// We can implement the same behavior as command2 using another SoxCommand as a subcommand\nvar trimSubcommand = SoxCommand()\n  .input('examples/assets/utterance_0.wav')\n  .outputFileType('wav')\n  .output('-p')\n  .trim(5, 35);\nvar command3 = SoxCommand()\n  .inputSubCommand(trimSubcommand);\n```\n\n#### Input Options\nThese methods set input-related options on the input that was *most recently added*, so you must add an input before calling these.\n\n* **`inputSampleRate(sampleRate)`** Set the sample rate in Hz (or kHz if appended with a 'k')\n* **`inputBits(bitRate)`**  Set the number of bits in each encoded sample\n* **`inputEncoding(encoding)`** Set the audio encoding type (sometimes needed with file-types that support more than one encoding, like raw or wav). The main available encoding types are:\n  * signed-integer\n  * unsigned-integer\n  * floating-point\n  * for more, see the [sox documentation](http://sox.sourceforge.net/sox.html#OPTIONS) for -e\n* **`inputChannels(numChannels)`**  Set the number of audio channels in the audio file\n* **`inputFileType(fileType)`** Set the type of the audio file\n\n```js\nvar command = SoxCommand();\ncommand.input(inputStream)\n  .inputSampleRate(44100)\n  .inputEncoding('signed')\n  .inputBits(16)\n  .inputChannels(1)\n  .inputFileType('raw');\n```\n\n### Outputs\nSoxCommands accept one or any number of outputs. There are 3 different acceptable types of outputs:\n* a file name, e.g. `'examples/outputs/utterance_0.wav'`\n* a writable stream, e.g. `fs.createWriteStream('examples/outputs/utterance_0.wav')`, however only one output stream may be used per command \n* the string `'-p'` or `'--sox-pipe'`, this can be used in place of an output filename to specify that the Sox command should be used as an input pipe into another Sox command. You may refer to the [sox documentation](http://sox.sourceforge.net/sox.html#FILENAMES) for -p\n\n#### Output Options\nThese methods set output-related options on the output that was *most recently added*, so you must add an output before calling these.\n\n* **`outputSampleRate(sampleRate)`** Set the sample rate in Hz (or kHz if appended with a 'k')\n* **`outputBits(bitRate)`**  Set the number of bits in each encoded sample\n* **`outputEncoding(encoding)`** Set the audio encoding type (sometimes needed with file-types that support more than one encoding, like raw or wav). The main available encoding types are:\n  * signed-integer\n  * unsigned-integer\n  * floating-point\n  * for more, see the [sox documentation](http://sox.sourceforge.net/sox.html#OPTIONS) for -e\n* **`outputChannels(numChannels)`**  Set the number of audio channels in the audio file\n* **`outputFileType(fileType)`** Set the type of the audio file to output, particularly important when the output is a stream\n\n```js\nvar command = SoxCommand();\ncommand.input(inputStream)\n  .inputSampleRate(44100)\n  .inputEncoding('signed')\n  .inputBits(16)\n  .inputChannels(1)\n  .inputFileType('raw');\n  \ncommand.output(outputStream)\n  .outputSampleRate(1600)\n  .outputEncoding('signed')\n  .outputBits(16)\n  .outputChannels(1)\n  .outputFileType('wav');\n```\n\n### Effects\nSoX can be used to invoke a number of audio 'effects', which should be provided at the end of the command. Multiple effects may be applied by specifying them one after another. You can [learn about all of the effects available to SoX here](http://sox.sourceforge.net/sox.html#EFFECTS). SoxCommand currently providers helpers for some popular effects, and a catch-all method to apply any of the other effects.\n\n#### `trim(position(+))` \nCuts portions out of the audio. Any number of _positions_ may be given, either individually or as a list, and each _position_ can be a number or formatted string. Once the first _position_ is reached, the effect alternates between copying and discarding the audio at each _position_. Using 0 for the first _position_ allows copying from the beginning of the audio. The format for a _position_ can be:\n  * `5.2` a number indicating 5.2 seconds from the previous _position_ or the start of the audio if there was no previous\n  * `'15:25.30'` a string indicating 15 minutes, 25 seconds, and 30 milliseconds from the previous _position_ or the start of the audio file\n  * `'=2:05'` a string indicating 2 minutes and 5 seconds into the audio file, relative to the start of the audio\n  * `'-3:30'` a string indicating 3 minutes and 30 seconds before the end of the audio file\n  * `'=1250s'` a string indicate 1250 samples into the audio file\n  \n#### `combine(method)`\nSelect the input file combining method, which can be one of the following strings:\n  * `'concatenate'`\n  * `'sequence'`\n  * `'mix'`\n  * `'mix-power'`\n  * `'merge'`\n  * `'multiply'`\n  \n#### `concat()`\nA shorthand for applying the concatenate combining method. The audio from each input will be concatenated in the order added to the command to form the output file. The input files must have the same number of channels.\n\n#### `addEffect(effectName, effectOptionsList)`\nA catch-all method allowing you to apply any SoX effect. Apply the SoX effect with `effectName` using the command line options provided in `effectOptionsList`. Please [refer to the SoX documentation on all available effects and their usages](http://sox.sourceforge.net/sox.html#EFFECTS).\n\n### Running a SoxCommand\nStarting the SoxCommand is as easy as \n```js\ncommand.run();\n```\nOf course, you need to fully specify the command first, with inputs, outputs, and optional effects. You can also set listeners on your command for `prepare`, `start`, `progress`, `error`, and `end` events.\n```js\nvar command = SoxCommand()\n  .input(...)\n  .output(...)\n  .addEffect(..., [...]);\n  \ncommand.on('prepare', function(args) {\n  console.log('Preparing sox command with args ' + args.join(' '));\n});\n\ncommand.on('start', function(commandLine) {\n  console.log('Spawned sox with command ' + commandLine);\n});\n\ncommand.on('progress', function(progress) {\n  console.log('Processing progress: ', progress);\n});\n\ncommand.on('error', function(err, stdout, stderr) {\n  console.log('Cannot process audio: ' + err.message);\n  console.log('Sox Command Stdout: ', stdout);\n  console.log('Sox Command Stderr: ', stderr)\n});\n\ncommand.on('end', function() {\n  console.log('Sox command succeeded!');\n});\n\ncommand.run();\n```\n\n### Selected Examples\nThe following example concatenates three audio files while trimming off the first 5 seconds of the first file, and the last 10 seconds of the last file through subcommands.\n```js\nvar SoxCommand = require('sox-audio');\nvar TimeFormat = SoxCommand.TimeFormat;\n\nvar command = SoxCommand();\n\nvar startTimeFormatted = TimeFormat.formatTimeAbsolute(5);\nvar endTimeFormatted = TimeFormat.formatTimeRelativeToEnd(10);\n\nvar trimFirstFileSubCommand = SoxCommand()\n\t.input('./assets/utterance_0.wav')\n\t.output('-p')\n\t.outputFileType('wav')\n\t.trim(startTimeFormatted);\n\nvar trimLastFileSubCommand = SoxCommand()\n\t.input('./assets/utterance_2.wav')\n\t.output('-p')\n\t.outputFileType('wav')\n\t.trim(0, endTimeFormatted);\n\ncommand.inputSubCommand(trimFirstFileSubCommand)\n  .input('./assets/utterance_1.wav');\n  .inputSubCommand(trimLastFileSubCommand)\n\t.output(outputFileName)\n\t.concat();\n\ncommand.run();\n```\n\nIn this example, a 44.1 kHz raw audio stream is converted on the fly to a 16 kHz wav audio stream.\n```js\nvar command = SoxCommand();\ncommand.input(inputStream)\n\t.inputSampleRate('44.1k')\n\t.inputEncoding('signed')\n\t.inputBits(16)\n\t.inputChannels(1)\n\t.inputFileType('raw')\n\t.output(outputPipe)\n\t.outputFileType('wav')\n\t.outputSampleRate('16k');\n\ncommand.run();\n```\n\n## License\nThis code is under the MIT License. \n",
  "readmeFilename": "README.md",
  "gitHead": "226cb7fc026e291e1ec71c03adda785ae09b304d",
  "_id": "sox-audio@0.2.0",
  "_shasum": "c631405160a400b57b6b7d14b975ec39793251a8",
  "_from": "sox-audio@*",
  "dependencies": {
    "through": "^2.3.6"
  }
}

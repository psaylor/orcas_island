define(["jquery","crossBrowserAudio","promise"],function(e,t,n){var r=new t.AudioContext,i={audio:!0,video:!1},s=t.promiseUserMedia(i).then(function(t){console.log("SharedAudio got localmediastream",typeof t);var n=r.createMediaStreamSource(t);return console.log("Created audio stream",typeof n),n}).error(function(t){alert("getUserMedia: "+t.name+"\n"+t.message),console.log("Media access rejected.",t)}),o=function(t){return new n(function(n,i){r.decodeAudioData.call(r,t,n,i)})},u=function(t){return new n(function(n,i){var s=r.createBufferSource();s.buffer=t,s.connect(r.destination),s.start(),s.onended=n})},a={audioContext:r,audioStreamPromise:s,promiseDecodeAudioData:o,promisePlayAudioData:u};return a});